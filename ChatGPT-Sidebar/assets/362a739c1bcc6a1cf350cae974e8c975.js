import{p as w,a as U,b as F}from"./55927474d50813754f9a258ed1359b8b.js";import{A as b,_ as k}from"./f7ec9d73290e3138867d7fb473ce8d7b.js";import{H as _,A as y}from"./e9f75e36460fce00961861b26033c5f6.js";import{d as C,H as I,bH as x,bM as d,a_ as u,aP as p,L as a,bc as c,X as D,aA as A,J as g,I as h}from"./857d445419d45c89a951acec196a4c6c.js";import"./397df68e72150072960998f20fc4b12d.js";import"./86e8490f22d5ffaff40ca5879db6ec11.js";import"./a711f3c80a9486a671fafd39f9c6a524.js";import"./e89f80fef20b267b41c7f233de7c44bc.js";import"./6af5ed63a73223aaf36e83f20fa1f6ae.js";import"./85b823c868a70ddd84c1c0306aac9f0e.js";import"./e8fce94663e5d679d1f5600ec59f654e.js";import"./b9f1ba746231db01e3edf3e495cf627c.js";import"./72fd4ee2d5a3adb51faedc97ae5209b5.js";import"./3178c8329fb7343c4a8df5c5d4b8f2f2.js";import"./658cf16f1475fd823ea3f6b38f5982b1.js";import"./e17dd21e954285ab8e57edc5aaa8d095.js";import"./7178c4095b3167bc462b8cb724642193.js";import"./4f72198a2c56625f6e2ce33df598b892.js";import"./12505fbd7c357225cfee202a261ae734.js";import"./20f06371b524a2c3b5ac6431576be3ce.js";import"./0c2332fe3748cc1a7d9e75130754fe1a.js";import"./843996722d01d8c64a3babfbb75a2562.js";import"./bc30000a11905b644c9c532ed7a81acc.js";w.GlobalWorkerOptions.workerSrc=U;const E=async a=>await new Promise(((e,t)=>{const i=new FileReader;i.onload=async a=>{var i;if(null!=(i=a.target)&&i.result)try{const t=await F.getDocument({data:a.target.result}).promise;let i="";for(let a=1;a<=t.numPages;a++)try{const e=undefined;i+=(await(await t.getPage(a)).getTextContent()).items.map((a=>a.str)).join(" ")}catch(r){console.log(`Error occurred while reading page ${a}: ${r}`);continue}t.destroy(),e(i)}catch(o){t(`Error occurred while reading PDF file: ${o}`)}else t("No result found")},i.onerror=()=>{t(`Error occurred while reading file: ${i.error}`)},i.readAsArrayBuffer(a)})),M=C({extends:b,name:"PdfUploader",data:()=>({pdfUploadErrorMessage:"",pdfUploadPromptId:"",pdfUploadIsProcessing:!1,pdfUploadDragActive:!1}),methods:{async uploadPDF(a){const e=a.target.files[0];await this.processFile(e)},dragOver(a){a.preventDefault(),this.pdfUploadDragActive=!0},dragEnter(a){a.preventDefault(),this.pdfUploadDragActive=!0},dragLeave(a){a.preventDefault(),this.pdfUploadDragActive=!1},async handleDrop(a){const e=a.dataTransfer.files[0];await this.processFile(e)},async processFile(a){if(a&&"application/pdf"===a.type&&a.name.toLowerCase().endsWith(".pdf")){this.pdfUploadErrorMessage="",this.pdfUploadIsProcessing=!0;try{const e=await E(a);if(""===e)return this.pdfUploadErrorMessage=this.__("Content of the file is empty. Please upload a regular PDF file. Photo converted PDF files cannot be used at ChatPDF"),void(this.pdfUploadIsProcessing=!1);this.changeStorage("settings.web_access",!1,!1),this.pdfUploadPromptId=_.SHA1(this.getFileName(a));const t="",i=a.name;this.newChat(),this.closeModel(),this.changeStorage("settings.ai_model",this.constants.ai_default_model),y.chat(e,this.constants.ai_default_model,"ai_chat","__all",!0,!1,i,!1,{is_pdf:!0,prompt_prefix:y.prompt_prefix,language_name:this.settings.language_name}),null!=document.querySelector("#fileInputPDF")&&(document.querySelector("#fileInputPDF").value=null)}catch(e){console.log(e),this.pdfUploadErrorMessage=this.__("Something went wrong. Please try again.")}finally{this.pdfUploadIsProcessing=!1}}else this.pdfUploadErrorMessage=this.__("Please upload a valid PDF file.")},getFileName:a=>_.slugify(a.name),closeModel(){let a=document.querySelector('[data-ait-dropdown-toggle="ait-pdf-upload-modal"]');a&&(this.pdfUploadPromptId="",a.click()),a=document.querySelector("#ait-pdf-upload-modal button[data-modal-hide]"),a&&(this.pdfUploadPromptId="",a.click())}}}),S={class:"ait-p-4 ait-w-full ait-text-center ait-flex ait-flex-col ait-items-center ait-gap-3"},N={class:"ait-px-4 ait-text-sm ait-text-neutral-600 dark:ait-text-neutral-400"},$=["disabled"],B={for:"fileInputPDF",class:"ait-w-full ait-h-full ait-relative ait-z-[9999]"},H={class:"ait-flex ait-flex-col ait-w-full ait-p-6 ait-items-center ait-justify-center ait-mt-4 ait-border-2 ait-border-dotted ait-border-neutral-300 dark:ait-border-neutral-700 ait-rounded-lg ait-text-neutral-600 dark:ait-text-neutral-400 ait-text-center ait-cursor-pointer ait-transition-all hover:ait-opacity-70"},q={class:"ait-flex ait-flex-col ait-items-center ait-gap-1 ait-mt-2"},L={class:"ait-block ait-text-xs"},O={key:0,class:"ait-flex ait-justify-center ait-items-center ait-h-25"},T={class:"ait-h-6"},V={key:0,class:"ait-text-red-500 ai-text-sm"},z={key:0,class:"ait-p-4"};function W(e,t,i,r,o,s){const l=u("svg-logo"),n=u("single-response"),f=u("modal");return p(),I(f,{title:e.__("Upload PDF"),id:"ait-pdf-upload-modal",className:"ait-items-center",onDrop:d(e.handleDrop,["prevent"]),onDragover:d(e.dragOver,["prevent"]),onDragenter:d(e.dragEnter,["prevent"]),onDragleave:d(e.dragLeave,["prevent"])},{default:x((()=>[a("div",S,[a("p",N,c(e.__("Upload a PDF File to easily get intelligent summaries and answers for your documents.")),1),a("input",{type:"file",id:"fileInputPDF",onChange:t[0]||(t[0]=(...a)=>e.uploadPDF&&e.uploadPDF(...a)),disabled:e.pdfUploadIsProcessing,accept:"application/pdf",style:{display:"none"}},null,40,$),a("label",B,[a("div",H,[D(l,{className:"ait-w-16 ait-h-16 ait-opacity-60",name:"pdf_icon"}),a("div",q,[a("span",L,c(e.__("Supported file type is PDF")),1)]),a("span",{class:A(["ait-block ait-mt-2",e.pdfUploadDragActive?"ait-opacity-100":"ait-opacity-60"])},c(e.pdfUploadDragActive?e.__("Drop your PDF here"):e.__("Drag your PDF here or click to upload")),3)])]),e.pdfUploadIsProcessing?(p(),g("div",O,t[1]||(t[1]=[a("div",{class:"ait-border-4 ait-border-solid ait-border-t-transparent ait-border-gray-200 ait-rounded-full ait-w-9 ait-h-9 ait-animate-spin"},null,-1)]))):h("",!0),a("div",T,[e.pdfUploadErrorMessage?(p(),g("p",V,c(e.pdfUploadErrorMessage),1)):h("",!0)])]),this.pdfUploadPromptId?(p(),g("div",z,[D(n,{class:"ait-p-2 ait-rounded-lg ait-bg-neutral-100 dark:ait-bg-neutral-900 dark:ait-text-gray-200",id:"aitopia-pdf-summary",custom_key:this.pdfUploadPromptId,onContinueChatClick:this.closeModel},null,8,["custom_key","onContinueChatClick"])])):h("",!0)])),_:1},8,["title","onDrop","onDragover","onDragenter","onDragleave"])}const ut=k(M,[["render",W]]);export{ut as default};